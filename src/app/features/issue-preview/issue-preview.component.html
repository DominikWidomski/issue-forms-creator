<section class="preview-options">
  <section class="errors-container">
    <ng-container *ngIf="form?.get('body')?.valueChanges | async">
      <app-error-message
        *ngFor="let error of errorsList"
        [hasLink]="false"
        [errorMessage]="error.message"
      ></app-error-message>
    </ng-container>
  </section>
  <section class="actions-container">
    <mat-button-toggle-group name="preview options" aria-label="preview options">
      <mat-button-toggle value="bold" checked>Live preview</mat-button-toggle>
      <mat-button-toggle value="italic" disabled matTooltip="work in progress"
        >Yaml preview</mat-button-toggle
      >
    </mat-button-toggle-group>
    <section class="clipboard-container">
      <button
        mat-raised-button
        class="clipboard-btn"
        color="primary"
        type="button"
        (click)="copyToClipboard.emit()"
      >
        copy yaml to clipboard
      </button>
      <span *ngIf="clipboardSuccess" class="clipboard-success">Copied!</span>
      <span *ngIf="clipboardError && form.invalid" class="clipboard-error"
        >Failed! Errors detected</span
      >
    </section>
  </section>
</section>
<section class="preview-container">
  <app-top-level-preview
    [name]="form.value.name"
    [description]="form.value.description"
    [title]="form.value.title"
    (scrollToError)="scrollToError.emit(0)"
  >
    <form [formGroup]="form">
      <section>
        <section *ngFor="let control of controls; let i = index">
          <article class="field" [ngSwitch]="control.controls.type.value">
            <app-markdown-preview
              *ngSwitchCase="'markdown'"
              [formGroup]="control"
            ></app-markdown-preview>
            <app-textarea-preview
              *ngSwitchCase="'textarea'"
              [formGroup]="control"
              (scrollToError)="scrollToError.emit(i + 1)"
            ></app-textarea-preview>
            <app-input-preview
              *ngSwitchCase="'input'"
              [formGroup]="control"
              (scrollToError)="scrollToError.emit(i + 1)"
            ></app-input-preview>
            <app-dropdown-preview
              *ngSwitchCase="'dropdown'"
              [formGroup]="control"
              (scrollToError)="scrollToError.emit(i + 1)"
            ></app-dropdown-preview>
            <app-checkboxes-preview
              *ngSwitchCase="'checkboxes'"
              [formGroup]="control"
              (scrollToError)="scrollToError.emit(i + 1)"
            ></app-checkboxes-preview>
          </article>
        </section>
      </section>
    </form>
  </app-top-level-preview>
  <section class="options-preview-container">
    <app-option-preview label="Assignees" [optionList]="form.value.assignees"></app-option-preview>
    <app-option-preview label="Labels" [optionList]="form.value.labels"></app-option-preview>
  </section>
</section>
