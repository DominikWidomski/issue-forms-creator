<mat-expansion-panel>

  <mat-expansion-panel-header>
    <mat-panel-title>
      <mat-chip-list>
        <!-- TODO : add color -->
        <mat-chip>dropdown</mat-chip>
      </mat-chip-list>
    </mat-panel-title>
    <mat-panel-description>
      <span class="error-message" *ngIf="isLabelInvalid; else labelValid">
        missing label
      </span>
      <ng-template #labelValid>
        {{label}}
      </ng-template>
    </mat-panel-description>
  </mat-expansion-panel-header>

  <section [formGroup]="formGroup">
    <mat-form-field class="element-creator-field">
      <mat-label>ID</mat-label>
      <input matInput type="text" formControlName="id">
      <mat-hint>Must be unique in the form definition</mat-hint>
    </mat-form-field>

    <section class="element-creator-container" formGroupName="attributes">
      <mat-form-field class="element-creator-field">
        <mat-label>label</mat-label>
        <input matInput type="text" formControlName="label">
        <mat-hint>A brief description of the expected user input</mat-hint>
      </mat-form-field>

      <mat-form-field class="element-creator-field">
        <mat-label>description</mat-label>
        <input matInput type="text" formControlName="description">
        <mat-hint>provide context or guidance</mat-hint>
      </mat-form-field>

      <mat-form-field class="element-creator-field">
        <mat-label>options</mat-label>
        <input
          matInput
          type="text"
          [formControl]="optionsControl"
          [matChipInputFor]="optionList"
          [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
          (matChipInputTokenEnd)="addOption($event)"
        >
        <mat-hint>placeholder that renders in the field when empty</mat-hint>
        <!-- TODO : should depend on optionList being empty and optionsControl being touched -->
        <mat-error *ngIf="false">must include at least one option</mat-error>
      </mat-form-field>
      <mat-chip-list
        #optionList
        cdkDropList
        cdkDropListOrientation="vertical"
        (cdkDropListDropped)="dropOption($event)">
        <mat-chip
          cdkDrag
          *ngFor="let option of options; let i = index"
          [removable]="true"
          (removed)="removeOption(i)"
        >
          {{option}}
          <mat-icon matChipRemove>cancel</mat-icon>
        </mat-chip>
      </mat-chip-list>
      <mat-checkbox formControlName="multiple">Multiple options can be selected</mat-checkbox>
    </section>

    <section class="element-creator-container" formGroupName="validations">
      <mat-checkbox formControlName="required">This element must be filled to submit an issue</mat-checkbox>
      <!-- TODO : add hint => Prevents form submission until element is completed. -->
    </section>

    <section class="actions-btn-container">
      <button mat-stroked-button color="warn" (click)="delete.emit()">
        delete
      </button>
    </section>
  </section>
</mat-expansion-panel>
